2025-11-04 13:19:40,995 [INFO] job_applications: ‚û°Ô∏è POST to http://app:3001/events/ with payload: {'metadata': {'tenant_id': '6746c2be-5c36-4e88-9d3d-83374f5157c5', 'event_type': 'candidate.shortlisted', 'event_id': 'aaa31d0f-ea14-4f75-b6cd-237b1c3c51c1', 'created_at': '2025-11-04T13:19:40.994693+00:00', 'source': 'job-applications'}, 'data': {'email': 'wisdomkayea16@gmail.com', 'full_name': 'Wisdom Kayea Front End Developer', 'application_id': 'c814393d-20d6-4a93-9d86-55ff8c092e89', 'job_requisition_id': 'PRO-0076', 'status': 'shortlisted', 'score': 19.59, 'has_employment_gaps': False, 'employment_gaps': [], 'timestamp': '2025-11-04T13:19:40.994915+00:00', 'user_agent': 'unknown'}}
2025-11-04 13:19:41,080 [INFO] job_applications: ‚úÖ Notification sent for candidate.shortlisted to wisdomkayea16@gmail.com. Status: 201, Response: {"success":true,"message":"Event received and processing started","jobIds":["355"]}
2025-11-04 13:19:41,080 [INFO] job_applications: Sent candidate.shortlisted notification to wisdomkayea16@gmail.com
2025-11-05 00:00:00,772 [INFO] job_applications: üöÄ Starting daily background CV vetting with full workflow
2025-11-05 00:00:01,096 [INFO] job_applications: Fetched 3 requisitions from page; next: False
2025-11-05 00:00:01,097 [INFO] job_applications: Total open requisitions fetched: 3
2025-11-05 00:00:01,097 [INFO] job_applications: Processing requisition PRO-0001
2025-11-05 00:00:01,414 [ERROR] job_applications: Daily vetting failed: connection to server at "job_app_postgres" (172.18.0.12), port 5432 failed: FATAL:  the database system is in recovery mode
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/django/db/backends/base/base.py", line 279, in ensure_connection
    self.connect()
  File "/usr/local/lib/python3.11/site-packages/django/utils/asyncio.py", line 26, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/django/db/backends/base/base.py", line 256, in connect
    self.connection = self.get_new_connection(conn_params)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/django/utils/asyncio.py", line 26, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/django/db/backends/postgresql/base.py", line 332, in get_new_connection
    connection = self.Database.connect(**conn_params)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "job_app_postgres" (172.18.0.12), port 5432 failed: FATAL:  the database system is in recovery mode


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/job_application/tasks.py", line 151, in daily_background_cv_vetting
    applications_list = list(applications)
                        ^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/django/db/models/query.py", line 502, in _iterator
    yield from iterable
  File "/usr/local/lib/python3.11/site-packages/django/db/models/query.py", line 91, in __iter__
    results = compiler.execute_sql(
              ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/django/db/models/sql/compiler.py", line 1619, in execute_sql
    cursor = self.connection.chunked_cursor()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/django/utils/asyncio.py", line 26, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/django/db/backends/postgresql/base.py", line 462, in chunked_cursor
    return self._cursor(
           ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/django_tenants/postgresql_backend/base.py", line 142, in _cursor
    cursor = super()._cursor(name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/django/db/backends/base/base.py", line 296, in _cursor
    self.ensure_connection()
  File "/usr/local/lib/python3.11/site-packages/django/utils/asyncio.py", line 26, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/django/db/backends/base/base.py", line 278, in ensure_connection
    with self.wrap_database_errors:
  File "/usr/local/lib/python3.11/site-packages/django/db/utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/usr/local/lib/python3.11/site-packages/django/db/backends/base/base.py", line 279, in ensure_connection
    self.connect()
  File "/usr/local/lib/python3.11/site-packages/django/utils/asyncio.py", line 26, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/django/db/backends/base/base.py", line 256, in connect
    self.connection = self.get_new_connection(conn_params)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/django/utils/asyncio.py", line 26, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/django/db/backends/postgresql/base.py", line 332, in get_new_connection
    connection = self.Database.connect(**conn_params)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
django.db.utils.OperationalError: connection to server at "job_app_postgres" (172.18.0.12), port 5432 failed: FATAL:  the database system is in recovery mode

